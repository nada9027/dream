<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>꿈 계획 도우미</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
        }
        .container {
            max-width: 90%;
            margin: 2rem auto;
            padding: 1.5rem;
            background-color: #ffffff;
            border-radius: 1.5rem; /* More rounded corners */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0; /* Light border */
        }
        textarea, input[type="text"] {
            padding: 0.8rem 1rem;
            border: 1px solid #cbd5e1;
            border-radius: 0.75rem; /* Rounded input fields */
            font-size: 1rem;
            resize: vertical;
            min-height: 50px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.06);
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        textarea:focus, input[type="text"]:focus {
            outline: none;
            border-color: #6366f1; /* Indigo focus ring */
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }
        button {
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out, box-shadow 0.2s ease-in-out;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
        }
        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .loading-indicator {
            display: none;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #6366f1; /* Indigo spinner */
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .message-box {
            display: none;
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 0.75rem;
            font-size: 0.95rem;
            color: #4a5568;
            background-color: #e2e8f0;
            border: 1px solid #cbd5e1;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .message-box.error {
            color: #c53030;
            background-color: #fed7d7;
            border-color: #feb2b2;
        }
        .message-box.info {
             color: #2b6cb0;
             background-color: #bee3f8;
             border-color: #90cdf4;
        }
        .evaluation-circle {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            flex-shrink: 0; /* Prevent shrinking in flex container */
            margin-right: 0.75rem; /* Space between circle and text */
        }
        .evaluation-O { background-color: #10b981; } /* Emerald green */
        .evaluation-triangle { background-color: #f59e0b; } /* Amber */
        .evaluation-X { background-color: #ef4444; } /* Red */

        /* Responsive adjustments */
        @media (min-width: 768px) {
            .container {
                max-width: 768px; /* Slightly wider on tablets */
            }
        }
        @media (min-width: 1024px) {
            .container {
                max-width: 960px; /* Even wider on desktops */
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 to-purple-50 min-h-screen flex items-center justify-center p-4">

    <div class="container w-full p-6 sm:p-8 md:p-10 flex flex-col gap-6">
        <h1 class="text-3xl sm:text-4xl font-bold text-center text-gray-800 mb-4">✨ 꿈 계획 도우미 ✨</h1>
        <p class="text-center text-gray-600 mb-6">여러분의 꿈과 각 연령대별 계획을 입력하면, AI가 아닌 **규칙 기반 시스템**이 평가하고 더 나은 방향을 제시해 드립니다.</p>

        <!-- Input Section -->
        <div class="input-section bg-gray-50 p-6 rounded-xl shadow-inner flex flex-col gap-4 border border-gray-200">
            <label for="dream" class="text-gray-700 font-semibold text-lg">나의 꿈:</label>
            <textarea id="dream" class="w-full" rows="2" placeholder="예: 세계 최고의 AI 개발자가 되어 인류의 삶을 개선하고 싶습니다."></textarea>

            <label for="planTeen" class="text-gray-700 font-semibold text-lg mt-4">10대 계획:</label>
            <textarea id="planTeen" class="w-full" rows="3" placeholder="예: 수학, 과학 공부를 열심히 하고 코딩 학원에 다닐 거예요. AI 관련 책을 많이 읽고 토론 동아리에 참여할 거예요."></textarea>

            <label for="plan20s" class="text-gray-700 font-semibold text-lg mt-4">20대 계획:</label>
            <textarea id="plan20s" class="w-full" rows="3" placeholder="예: 명문대 컴퓨터공학과에 진학하고 AI 연구실에서 인턴십을 할 거예요. 해외에서 유학하며 AI 분야 최고 전문가들과 교류할 거예요."></textarea>

            <label for="plan30s" class="text-gray-700 font-semibold text-lg mt-4">30대 계획:</label>
            <textarea id="plan30s" class="w-full" rows="3" placeholder="예: 실리콘밸리에서 AI 스타트업을 창업하거나 대기업 AI 연구소에서 핵심 역할을 맡을 거예요. 사회 문제 해결에 기여하는 AI 모델을 개발할 거예요."></textarea>

            <button id="evaluateButton" class="bg-indigo-600 text-white hover:bg-indigo-700 mt-6 transform transition-all duration-200 ease-in-out">
                내 계획 평가받기
            </button>
            <div id="loadingIndicator" class="loading-indicator mx-auto mt-4"></div>
            <div id="messageBox" class="message-box"></div>
        </div>

        <!-- Output Section -->
        <div id="outputSection" class="output-section bg-blue-50 p-6 rounded-xl shadow-md border border-blue-200 mt-8 hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">계획 평가 및 조언</h2>
            <div id="overallEvaluation" class="bg-purple-100 p-4 rounded-lg mb-6 shadow-sm text-center text-gray-700 font-medium"></div>

            <div id="decadeResults" class="flex flex-col gap-6">
                <!-- Results for each decade will be inserted here by JavaScript -->
            </div>
            <button id="resetButton" class="bg-gray-300 text-gray-800 hover:bg-gray-400 mt-8 transform transition-all duration-200 ease-in-out w-full">
                새로운 계획 세우기
            </button>
        </div>
    </div>

    <script>
        const evaluateButton = document.getElementById('evaluateButton');
        const resetButton = document.getElementById('resetButton');
        const dreamInput = document.getElementById('dream');
        const planTeenInput = document.getElementById('planTeen');
        const plan20sInput = document.getElementById('plan20s');
        const plan30sInput = document.getElementById('plan30s');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const outputSection = document.getElementById('outputSection');
        const overallEvaluationDiv = document.getElementById('overallEvaluation');
        const decadeResultsDiv = document.getElementById('decadeResults');
        const messageBox = document.getElementById('messageBox');

        // 메시지 박스 표시 함수
        function showMessageBox(message, type = 'info') {
            messageBox.textContent = message;
            messageBox.className = `message-box ${type}`; // Reset and apply type class
            messageBox.style.display = 'block';
        }

        // 메시지 박스 숨김 함수
        function hideMessageBox() {
            messageBox.style.display = 'none';
            messageBox.textContent = '';
        }

        // 입력 필드 초기화
        function clearInputs() {
            dreamInput.value = '';
            planTeenInput.value = '';
            plan20sInput.value = '';
            plan30sInput.value = '';
        }

        // 결과 영역 초기화 및 숨기기
        function hideOutput() {
            outputSection.classList.add('hidden');
            overallEvaluationDiv.innerHTML = '';
            decadeResultsDiv.innerHTML = '';
        }

        /**
         * 클라이언트 측에서 규칙 기반으로 계획을 평가하는 함수.
         * 이 함수는 API 호출 없이, 입력된 텍스트의 길이와 특정 키워드 포함 여부 등을 기반으로 평가합니다.
         * @param {string} dream 사용자의 꿈
         * @param {string} planTeen 10대 계획
         * @param {string} plan20s 20대 계획
         * @param {string} plan30s 30대 계획
         * @returns {object} 평가 결과 객체
         */
        function evaluatePlanClientSide(dream, planTeen, plan20s, plan30s) {
            let overallEvalMessage = "";
            let overallScore = 0; // 점수가 높을수록 좋은 계획

            const commonKeywords = ["공부", "배우", "연습", "참여", "시작", "개발", "경험", "프로젝트", "네트워킹", "자격증", "진학", "취업", "창업", "전문가", "기술", "연구", "독서", "탐구", "준비", "개선", "확장", "협력", "도전"];
            const dreamKeywords = dream.toLowerCase().split(' '); // 꿈에서 키워드 추출

            // 각 연령대별 계획을 평가하는 내부 함수
            const evaluateDecade = (plan, ageGroup) => {
                let evaluation = "△";
                let refinedPlan = "";
                let score = 0;

                let keywordCount = 0;
                commonKeywords.forEach(keyword => {
                    if (plan.includes(keyword)) {
                        keywordCount++;
                    }
                });

                // 꿈 관련 키워드가 계획에 포함되었는지 확인
                let dreamKeywordMatch = false;
                for (const dk of dreamKeywords) {
                    if (dk.length > 1 && plan.includes(dk)) { // 한 글자 키워드는 무시
                        dreamKeywordMatch = true;
                        break;
                    }
                }

                // 기본적인 길이 및 키워드 기반 평가
                if (plan.length < 20 || keywordCount < 1) {
                    evaluation = "X";
                    score = -1;
                    refinedPlan = `${ageGroup} 계획이 너무 간략하거나 구체성이 부족합니다. 어떤 활동을 통해 꿈에 다가갈지 구체적으로 작성해주세요. (예: 어떤 과목을 공부할지, 어떤 기술을 익힐지, 어떤 경험을 할지 등을 추가해 보세요.)`;
                } else if (plan.length < 50 || keywordCount < 3 || !dreamKeywordMatch) {
                    evaluation = "△";
                    score = 0;
                    refinedPlan = `${ageGroup} 계획이 좋습니다만, 좀 더 구체적인 행동 계획이나 꿈과의 연결성이 필요합니다. (예: 목표 달성을 위한 구체적인 방법, 필요한 자원, 예상되는 어려움과 극복 방안 등을 고민해보세요. 꿈과 직접적으로 연관된 활동을 추가하는 것도 좋습니다.)`;
                } else {
                    evaluation = "O";
                    score = 1;
                    refinedPlan = `${ageGroup} 계획이 아주 훌륭합니다! 구체적이고 꿈과 잘 연결되어 있습니다. 이대로 꾸준히 실행해 나간다면 꿈에 더 가까워질 수 있을 거예요. (계획에 대한 세부 목표와 일정을 추가하면 더욱 좋습니다.)`;
                }

                // 꿈의 종류에 따른 추가 조언 (예시: AI/개발자 꿈)
                if (dream.includes("AI") || dream.includes("개발자") || dream.includes("소프트웨어") || dream.includes("IT")) {
                    if (ageGroup === "10대" && (!plan.includes("코딩") && !plan.includes("수학") && !plan.includes("과학"))) {
                        if (evaluation === "O") evaluation = "△"; // O였다면 △로 낮춤
                        refinedPlan += " AI/개발자 꿈이라면, 10대에는 코딩 기초와 수학/과학적 사고력 함양이 특히 중요합니다. 관련 교육이나 활동을 추가해 보세요.";
                    } else if (ageGroup === "20대" && (!plan.includes("대학") && !plan.includes("인턴") && !plan.includes("프로젝트"))) {
                        if (evaluation === "O") evaluation = "△";
                        refinedPlan += " AI/개발자 꿈이라면, 20대에는 전문적인 교육기관에서의 학습과 실무 경험(인턴십, 프로젝트 등)이 필수적입니다. 이러한 내용을 추가해 보세요.";
                    } else if (ageGroup === "30대" && (!plan.includes("창업") && !plan.includes("리더") && !plan.includes("기여"))) {
                        if (evaluation === "O") evaluation = "△";
                        refinedPlan += " AI/개발자 꿈이라면, 30대에는 리더십 경험이나 사회에 기여할 수 있는 프로젝트 참여 등을 고려해 보세요. 커리어 발전의 중요한 시기입니다.";
                    }
                }
                
                // 꿈이 '예술가'인 경우
                if (dream.includes("예술가") || dream.includes("디자이너") || dream.includes("작가") || dream.includes("음악가")) {
                    if (ageGroup === "10대" && (!plan.includes("연습") && !plan.includes("창작") && !plan.includes("미술") && !plan.includes("음악"))) {
                        if (evaluation === "O") evaluation = "△";
                        refinedPlan += " 예술 분야의 꿈이라면, 10대에는 기본적인 기술 연습, 다양한 작품 감상, 그리고 자신만의 창작 활동을 시작하는 것이 중요합니다.";
                    } else if (ageGroup === "20대" && (!plan.includes("전공") && !plan.includes("공모전") && !plan.includes("개인전"))) {
                        if (evaluation === "O") evaluation = "△";
                        refinedPlan += " 20대에는 전문적인 예술 교육을 받고, 공모전이나 개인전 등 작품을 선보일 기회를 찾는 것이 좋습니다.";
                    }
                }


                return {
                    ageGroup: ageGroup,
                    evaluation: evaluation,
                    originalPlan: plan,
                    refinedPlan: refinedPlan
                };
            };

            // 각 연령대별 계획을 평가
            const teenEval = evaluateDecade(planTeen, "10대");
            const twentyEval = evaluateDecade(plan20s, "20대");
            const thirtyEval = evaluateDecade(plan30s, "30대");

            // 전체적인 평가 점수 계산
            overallScore = (teenEval.evaluation === 'O' ? 1 : (teenEval.evaluation === '△' ? 0 : -1)) +
                           (twentyEval.evaluation === 'O' ? 1 : (twentyEval.evaluation === '△' ? 0 : -1)) +
                           (thirtyEval.evaluation === 'O' ? 1 : (thirtyEval.evaluation === '△' ? 0 : -1));

            // 전체 평가 메시지 결정
            if (overallScore >= 2) {
                overallEvalMessage = "전반적인 계획이 아주 훌륭하고 체계적입니다! 꿈을 향한 여정이 기대됩니다.";
            } else if (overallScore >= 0) {
                overallEvalMessage = "계획의 방향성은 좋지만, 몇몇 부분에서 구체화가 더 필요합니다. 조언을 참고하여 계획을 다듬어 보세요.";
            } else {
                overallEvalMessage = "계획의 전반적인 구체성이 부족합니다. 각 연령대별 조언을 참고하여 목표를 더욱 명확히 설정해 보세요.";
            }

            // 평가 결과 반환
            return {
                overallEvaluation: overallEvalMessage,
                decadeEvaluations: [teenEval, twentyEval, thirtyEval]
            };
        }

        evaluateButton.addEventListener('click', async () => {
            hideMessageBox(); // 이전 메시지 지우기
            const dream = dreamInput.value.trim();
            const planTeen = planTeenInput.value.trim();
            const plan20s = plan20sInput.value.trim();
            const plan30s = plan30sInput.value.trim();

            if (!dream || !planTeen || !plan20s || !plan30s) {
                showMessageBox('모든 필드를 채워주세요!', 'error');
                return;
            }

            evaluateButton.disabled = true;
            loadingIndicator.style.display = 'block';
            hideOutput(); // 이전 결과 숨기기

            // API 호출 대신 클라이언트 측 함수 호출
            const evaluationResult = evaluatePlanClientSide(dream, planTeen, plan20s, plan30s);

            overallEvaluationDiv.textContent = evaluationResult.overallEvaluation;
            decadeResultsDiv.innerHTML = ''; // 이전 결과 지우기

            evaluationResult.decadeEvaluations.forEach(decade => {
                const decadeDiv = document.createElement('div');
                decadeDiv.className = 'bg-white p-5 rounded-lg shadow-md border border-gray-200 flex flex-col gap-3';

                let evaluationClass = '';
                let evaluationText = '';
                if (decade.evaluation === 'O') {
                    evaluationClass = 'evaluation-O';
                    evaluationText = '적절';
                } else if (decade.evaluation === '△') {
                    evaluationClass = 'evaluation-triangle';
                    evaluationText = '세모';
                } else if (decade.evaluation === 'X') {
                    evaluationClass = 'evaluation-X';
                    evaluationText = '엑스';
                }

                decadeDiv.innerHTML = `
                    <div class="flex items-center mb-2">
                        <div class="evaluation-circle ${evaluationClass}">${decade.evaluation}</div>
                        <h3 class="text-xl font-semibold text-gray-800">${decade.ageGroup} 계획</h3>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-md text-gray-700">
                        <p class="font-medium mb-1">나의 계획:</p>
                        <p>${decade.originalPlan}</p>
                    </div>
                    <div class="bg-blue-50 p-3 rounded-md text-gray-700">
                        <p class="font-medium mb-1">조언:</p>
                        <p>${decade.refinedPlan}</p>
                    </div>
                `;
                decadeResultsDiv.appendChild(decadeDiv);
            });
            outputSection.classList.remove('hidden'); // 결과 표시

            evaluateButton.disabled = false;
            loadingIndicator.style.display = 'none';
        });

        resetButton.addEventListener('click', () => {
            clearInputs();
            hideOutput();
            hideMessageBox();
            // 입력 섹션으로 스크롤
            dreamInput.focus();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    </script>
</body>
</html>
